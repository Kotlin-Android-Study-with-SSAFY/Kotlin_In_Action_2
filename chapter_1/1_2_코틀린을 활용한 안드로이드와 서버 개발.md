# 코틀린을 활용한 안드로이드와 서버 개발

> Kotlin in action (p.43 ~ p.47)

<aside>
💡

### 1.3 코틀린 응용

</aside>

**코틀린 서버 프로그래밍**

서버 프로그래밍이란

- 브라우저에 HTML 페이지를 돌려주는 웹 애플리케이션
- 모바일 애플리케이션에게 HTTP를 통해 JSON API를 제공하는 백엔드 애플리케이션
- RPC(원격 프로시저 호출) 프로토콜을 통해 서로 통신하는 작은 서비스들로 이뤄진 마이크로서비스

📎 코틀린의 특징

- 새로운 컴포넌트를 작성하거나 기존 서비스 코드를 코틀린으로 이식하기 쉽다. → 자바 코드와 매끄럽게 상호운용할 수 있다.
- 자바 클래스 →코틀린으로 확장해도 문제 X, 코틀린 클래스 안의 메소드나 필드에 특정 애노테이션을 붙이는 경우도 문제 X

코틀린 빌더 패턴을 활용하면 간결한 구문을 사용해서 객체로 이뤄진 그래프를 쉽게 구축할 수 있다.

또한 코틀린이 제공하는 완전한 추상화와 코드 재활용을 지속적으로 누릴 수 있다.

> 빌더 패턴: 객체를 생성할 때 복잡한 과정을 쉽게 처리해주는 패턴
> → 메서드 체이닝을 통해 가독성이 높아진다.
> → 코틀린 DSL 스타일로 활용 가능하다. (Lambda + 확장 함수 활용)

예를 들어 HTML 생성 라이브러리를 통해 외부 HTML 템플릿 라이브러리를 대신할 수 있다.

```kotlin
fun renderPersonList(persons: Collection<Person>)=
	createHTML().table{
		for(person in persons){
			tr{
				td{ +person.name}
				td{ +person.age}
			}
		}
	}
```

HTML 태그로 변환될 함수와 일반 코들린 언어 기능을 쉽게 조합할 수 있다. → 별도의 템플릿 언어를 사용할 필요가 없기 때문에 새로운 언어의 문법을 익힐 필요도 없다.

**영속성 프레임워크 (코틀린의 DSL 기능)**

예를 들어 exposed 프레임워크는 SQL 데이터베이스의 구조를 기술할 수 있는 읽기 쉬운 DSL을 제공→ 코틀린 코드만으로 완전한 타입검사를 지원하면서 데이터베이스 질의 실행 가능

```kotlin
//데이터베이스 테이블에 대해 기술한다.
object CountryTable: IdTable(){
	val name= varchar("name",250).uniqueIndex()
	val iso= varchar("iso",2).uniqueIndex()
}

//데이터베이스 엔티티에 해당하는 클래스를 만든다.
class Country(id: EntityID): Entity(id){
	var name: String by CountryTable.name
	var iso: String by CountryTable.iso
}

//오직 코틀린 코드만으로 이 데이터베이스에 질의를 던질 수 있다.
val russia= Country.find{ //코틀린 고차함수 문법
	CountryTable.iso.eq("ru") //eq: 코틀린에서 제공하는 타입 안전한 SQL 쿼리 작성 방식
}.first()//조회된 결과에서 첫번째 레코드를 가지고온다.(kotlin 컬렉션 확장 함수)

println(russia.name)
```

---

**코틀린 안드로이드 프로그래밍**

전형적인 모바일 애플리케이션 vs 전형적인 엔터프라이즈 애플리케이션

| 전형적인 모바일 애플리케이션    | 전형적인 엔터프라이즈 애플리케이션 |
| ------------------------------- | ---------------------------------- |
| 개인 사용자 중심(SNS, 유틸리티) | 기업 내부 업무 및 데이터 관리      |
| 규모 작음                       | 대규모 데이터 & 복잡한 시스템 연동 |
| 자주 업데이트 & 빠른 배포       | 안정성이 중요 → 신중한 배포        |

→ 모바일 애플리케이션은 보통 더 다양한 디바이스에 대해 서비스의 신뢰성을 보장하면서 더 빠르게 개발해 배포할 필요가 있다.

코틀린 언어 특성 + 안드로이드 프레임워크의 특별한 컴파일러 플러그인 지원⇒안드로이드 개발 작업을 훨씬 더 적은 코드로 달성 가능! 때로는 전혀 코드를 작성하지 않아도 컴파일러가 자동으로 필요 코드 생성

```kotlin
verticalLayout{ //단순한 텍스트 필드
	val name= editText()
	button("Say Hello"){
		onClick{toast("Hello, ${name.txt}!")}
	}
}

```

> **코틀린 사용 이점**

🧷 애플리케이션의 신뢰성이 높아진다.

왜냐하면,,,,
코틀린 타입 시스템은 null 값을 정확히 추적하며 널 포인터로 인해 생기는 문제를 줄여준다. (Java에서 NullPointerException을 일으키는 코드는 코틀린에서는 컴파일도 안됨)

🧷 코틀린은 자바 6와 완전히 호환
사용자의 디바이스에 최신 안드로이드가 탑재되지 않은 경우도 문제 없다.

🧷 성능 측면 손해 없다
코틀린의 런타임 시스템은 상당히 작기 때문에 컴파일 후 패키징한 애플리케이션 크기도 자바 애플리케이션이란 비슷하다.

🧷 대부분의 코틀린 라이브러리 함수는 인자로 받은 람다 함수를 인라이닝한다.
람다 표현식이 함수 객체로 변환되는 오버헤드를 inline 키워드를 사용하면 람다를 인라이닝 하여 성능 최적화 가능

>

---

<aside>
💡

\*\*QUIZ

Q:\*\* 코틀린의 타입 시스템은 null 값을 정확히 추적하여 NullPointerException을 완전히 방지할 수 있다. (O/X)

**Q:** 코틀린에서 SQL 데이터베이스의 구조를 기술할 수 있도록 지원하는 DSL 기반 프레임워크의 이름은 무엇인가?

</aside>
