# ì§€ì—° ê³„ì‚°(lazy) ì»¬ë ‰ì…˜ ì—°ì‚°

> Kotlin in action (p.223 ~ p.229)
>
> mapì´ë‚˜ filter ê°™ì€ ì»¬ë ‰ì…˜ í•¨ìˆ˜ëŠ” ê²°ê³¼ ì»¬ë ‰ì…˜ì„ ì¦‰ì‹œ ìƒì„±í•œë‹¤. â†’ ì»¬ë ‰ì…˜ í•¨ìˆ˜ë¥¼ ì—°ì‡„í•˜ë©´ ë§¤ ë‹¨ê³„ë§ˆë‹¤ ê³„ì‚° ì¤‘ê°„ ê²°ê³¼ë¥¼ ìƒˆë¡œìš´ ì»¬ë ‰ì…˜ì— ì„ì‹œë¡œ ë‹´ëŠ”ë‹¤

ğŸ’¡ ì‹œí€€ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì¤‘ê°„ ì„ì‹œ ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ ì»¬ë Œì…˜ ì—°ì‚°ì„ ì—°ì‡„í•  ìˆ˜ ìˆë‹¤. 

```kotlin
people.map(Person::name).filter {it.startWith("A")}
```

â†’ filterì™€ mapì€ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ë¦¬ìŠ¤íŠ¸ë¥¼ 2ê°œ ë§Œë“œëŠ” ê²ƒì´ë‹¤. í•œ ë¦¬ìŠ¤íŠ¸ëŠ” mapì˜ ê²°ê³¼ë¥¼ ë‹´ê³ , ë‹¤ë¥¸ í•˜ë‚˜ëŠ” filterì˜ ê²°ê³¼ë¥¼ ë‹´ëŠ”ë‹¤.  (ë¹„íš¨ìœ¨ì )

```kotlin
people.asSequence() //ì›ë³¸ ì»¬ë ‰ì…˜ì„ ì‹œí€€ìŠ¤ë¡œ ë³€í™˜í•œë‹¤. ì‹œí€€ìŠ¤ë„ ì»¬ë ‰ì…˜ê³¼ ë˜‘ê°™ì€ API ì œê³µ 
	.map(Person::name) 
	.filter(it.startWith("A") }
	.toList() //ê²°ê³¼ ì‹œí€€ìŠ¤ë¥¼ ë‹¤ì‹œ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜ 
```

â†’ ì¤‘ê°„ ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ì»¬ë ‰ì…˜ì´ ìƒê¸°ì§€ ì•Šê¸° ë•Œë¬¸ì— ì›ì†Œê°€ ë§ì€ ê²½ìš° ì„±ëŠ¥ì´ ëˆˆì— ë„ê²Œ ì¢‹ì•„ì§„ë‹¤. 

ì½”í‹€ë¦° ì§€ì—° ê³„ì‚° ì‹œí€€ìŠ¤ëŠ” Sequence ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì‹œì‘í•œë‹¤. ì´ ì¸í„°í˜ì´ìŠ¤ëŠ” ë‹¨ì§€ í•œ ë²ˆì— í•˜ë‚˜ì”© ì—´ê±°ë  ìˆ˜ ìˆëŠ” ì›ì†Œì˜ ì‹œí€€ìŠ¤ë¥¼ í‘œí˜„í•  ë¿ì´ë‹¤.  ì¦‰, í•œ ë²ˆì— í•œ ìš”ì†Œì”© ì²˜ë¦¬í•˜ëŠ” ì»¬ë ‰ì…˜ì´ë‹¤. 

Sequence ì•ˆì—ëŠ” iteratorë¼ëŠ” ë‹¨ í•˜ë‚˜ì˜ ë©”ì†Œë“œë¥¼ í†µí•´ ì‹œí€€ìŠ¤ë¡œë¶€í„° ì›ì†Œ ê°’ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. 

**ğŸš— ì»¬ë ‰ì…˜ vs ğŸš¶ ì‹œí€€ìŠ¤(Sequence)**

| ê°œë… | ì»¬ë ‰ì…˜  | ì‹œí€€ìŠ¤  |
| --- | --- | --- |
| ì‹¤í–‰ ë°©ì‹ | **ì¦‰ì‹œ ì‹¤í–‰ (Eager)** | **ì§€ì—° ì‹¤í–‰ (Lazy)** |
| ë°ì´í„° ì²˜ë¦¬ | ëª¨ë“  ìš”ì†Œë¥¼ í•œ ë²ˆì— ë³€í™˜ | í•œ ìš”ì†Œì”© ë³€í™˜ |
| ì¤‘ê°„ ì—°ì‚° (`map`, `filter` ë“±) | ì¦‰ì‹œ ìƒˆ ë¦¬ìŠ¤íŠ¸ ìƒì„± | ìµœì¢… ì—°ì‚° ì‹œ í•œ ë²ˆì— ì‹¤í–‰ |
| ì‚¬ìš© ì˜ˆì‹œ | ì‘ì€ ë°ì´í„° ì²˜ë¦¬ì— ì í•© | ëŒ€ëŸ‰ ë°ì´í„° ì²˜ë¦¬ì— ì í•© |

```kotlin
fun main() {
    val list = listOf(1, 2, 3, 4, 5)

    // mapì´ ì „ì²´ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³€í™˜í•œ í›„, filterê°€ ì‹¤í–‰ë¨ (ë¹„íš¨ìœ¨ì )
    val result = list.map { 
        println("Mapping: $it")
        it * 2 
    }.filter { 
        println("Filtering: $it")
        it > 5 
    }

    println(result) 
}

```

```kotlin
fun main() {
    val list = listOf(1, 2, 3, 4, 5)

    val result = list.asSequence()
        .map { 
            println("Mapping: $it")
            it * 2 
        }
        .filter { 
            println("Filtering: $it")
            it > 5 
        }
        .toList() // ìµœì¢… ì—°ì‚° (ì—¬ê¸°ì„œë§Œ ì‹¤í–‰ë¨)

    println(result)
}

```

ì‹œí€€ìŠ¤ì˜ ì›ì†ŒëŠ” í•„ìš”í•  ë•Œ ë¹„ë¡œì†Œ ê³„ì‚°ëœë‹¤. â†’ ì¤‘ê°„ ì²˜ë¦¬ ê²°ê³¼ë¥¼ ì €ì¥í•˜ì§€ ì•Šê³ ë„ ì—°ì‚°ì„ ì—°ì‡„ì ìœ¼ë¡œ ì ìš©í•´ì„œ íš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚°ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. 

> Quiz!!
asSequence í™•ì¥ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ì–´ë–¤ ì»¬ë ‰ì…˜ì´ë“  ì‹œí€€ìŠ¤ë¡œ ë°”ê¿€ ìˆ˜ ìˆì„ê¹Œ?
> 

Sequenceë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë§Œë“¤ ë•ŒëŠ” **toList**ë¥¼ ì‚¬ìš©í•œë‹¤. 

ì‹œí€€ìŠ¤ì— ëŒ€í•œ ì—°ì‚°ì„ ì§€ì—° ê³„ì‚°í•˜ê¸° ë•Œë¬¸ì— ì •ë§ ê³„ì‚°ì„ ì‹¤í–‰í•˜ê²Œ ë§Œë“¤ë ¤ë©´ ìµœì¢… ì‹œí€€ìŠ¤ì˜ ì›ì†Œë¥¼ í•˜ë‚˜ì”© ì´í„°ë ˆì´ì…˜í•˜ê±°ë‚˜ ìµœì¢… ì‹œí€€ìŠ¤ë¥¼ ë³€í™˜í•´ì•¼ í•œë‹¤. 

## ì‹œí€€ìŠ¤ ì—°ì‚° ì‹¤í–‰: ì¤‘ê°„ ì—°ì‚°ê³¼ ìµœì¢… ì—°ì‚°

ì¤‘ê°„ ì—°ì‚°: ë‹¤ë¥¸ ì‹œí€€ìŠ¤ë¥¼ ë°˜í™˜í•œë‹¤. â†’ ê·¸ ì‹œí€€ìŠ¤ëŠ” ìµœì´ˆ ì‹œí€€ìŠ¤ì˜ ì›ì†Œë¥¼ ë°˜í™˜í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‹¤. 

ìµœì¢… ì—°ì‚°: ê²°ê³¼ë¥¼ ë°˜í™˜â†’ ìµœì´ˆ ì»¬ë ‰ì…˜ì— ëŒ€í•´ ë³€í™˜ì„ ì ìš©í•œ ì‹œí€€ìŠ¤ë¡œë¶€í„° ì¼ë ¨ì˜ ê³„ì‚°ì„ ìˆ˜í–‰í•´ ì–»ì„ ìˆ˜ ìˆëŠ” ì»¬ë ‰ì…˜ì´ë‚˜ ì›ì†Œ, ìˆ«ì ë˜ëŠ” ê°ì²´ì´ë‹¤. 

ì¤‘ê°„ ì—°ì‚°ì€ í•­ìƒ ì§€ì—° ê³„ì‚°ëœë‹¤.

```kotlin
listOf(1,2,3,4).asSequence()
	.map{ print("map($it)"); it*it}
	.filter{ print("filter($it)"); it%2==0}
```

ì´ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ì•„ë¬´ ë‚´ìš©ë„ ì¶œë ¥ë˜ì§€ ì•ŠëŠ”ë‹¤. ì´ëŠ” mapê³¼ filter ë³€í™˜ì´ ëŠ¦ì¶°ì ¸ì„œ ê²°ê³¼ë¥¼ ì–»ì„ í•„ìš”ê°€ ìˆì„ë•Œ (ì¦‰, ìµœì¢… ì—°ì‚°ì´ í˜¸ì¶œë  ë•Œ) ì ìš©ëœë‹¤. 

ìµœì¢…ì—°ì‚°ì„ í˜¸ì¶œí•˜ë©´ ì—°ê¸°ëë˜ ëª¨ë“  ê³„ì‚°ì´ ìˆ˜í–‰ëœë‹¤.  

```kotlin
println(listOf(1,2,3,4).asSequence()
												.map{it*it}.find{it>3})
```

ìœ„ ì—°ì‚°ì„ ì»¬ë ‰ì…˜ì— ìˆ˜í–‰í•˜ë©´? 

ì‹œí€€ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´?  ì§€ì—° ê³„ì‚°ìœ¼ë¡œ ì¸í•´ ì›ì†Œ ì¤‘ ì¼ë¶€ì˜ ê³„ì‚°ì„ ì´ë¤„ì§€ì§€ ì•ŠëŠ”ë‹¤. 

![image](https://github.com/user-attachments/assets/2b93b589-8fcf-4b37-93dd-004e1f5cddf0)


```kotlin
val people=listOf(Person("Alice", 29), Person("Bob",31), 
				Person("Charles",31), Person("Dan",21))

println(people.asSequence().map(Person::name)
				.filter{it.length<4}.toList())
				

println(people.asSequence().filter{it.name.length<4}
				.map(Person::name).toList())

```
![image](https://github.com/user-attachments/assets/8d454f99-74f9-42ac-b04b-7325189e8b12)


mapì„ ë¨¼ì € í•˜ë©´ ëª¨ë“  ì›ì†Œë¥¼ ë°˜í™˜í•œë‹¤. í•˜ì§€ë§Œ filterë¥¼ ë¨¼ì € í•˜ë©´ ë¶€ì ì ˆí•œ ì›ì†Œë¥¼ ì œì™¸í•˜ê¸° ë•Œë¬¸ì— ë” íš¨ìœ¨ì ì´ë‹¤. 

## ì‹œí€€ìŠ¤ ë§Œë“¤ê¸°

asSequence() ë§ê³  generateSequence í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 

generateSequence: ì´ì „ì˜ ì›ì†Œë¥¼ ì¸ìë¡œ ë°›ì•„ ë‹¤ìŒ ì›ì†Œë¥¼ ê³„ì‚°í•œë‹¤. 

â†’ ì»¬ë ‰ì…˜ ì—†ì´ë„ ì§ì ‘ ì‹œí€€ìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤. 

```kotlin
val naturalNumbers= generateSequence(0) {it+1} //0ë¶€í„° ì‹œì‘í•´ì„œ ë‹¤ìŒ ìˆ«ìë¥¼ ê³„ì† ìƒì„±í•˜ëŠ” ì‹œí€€ìŠ¤
val numbersTo100=naturalNumbers.takeWhile {it<=100} //100ì´í•˜ë§Œ ê°€ì ¸ì˜¤ê¸° 
println(numbersTo100.sum()) //ëª¨ë“  ì§€ì—° ì—°ì‚°ì€ sumì˜ ê²°ê³¼ë¥¼ ê³„ì‚°í•  ë•Œ ìˆ˜í–‰ëœë‹¤. 
```

takeWhileë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬´í•œ ë£¨í”„ ë°©ì§€
